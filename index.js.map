{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["const API_KEY = '52395439-1c1f05bbfb1dbdeee6be85271'; \nconst BASE_URL = 'https://pixabay.com/api/';\nconst PER_PAGE = 15; \n\nexport async function getImagesByQuery(query, page = 1) {\n  if (!query || typeof query !== 'string') {\n    throw new Error('Query must be a non-empty string');\n  }\n  const url = `${BASE_URL}?key=${API_KEY}&q=${encodeURIComponent(\n    query\n  )}&image_type=photo&orientation=horizontal&safesearch=true&page=${page}&per_page=${PER_PAGE}`;\n\n  const response = await fetch(url);\n  if (!response.ok) {\n    throw new Error(`Pixabay API error: ${response.status}`);\n  }\n  const data = await response.json();\n    return data;\n}\n","\n\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst galleryContainer = document.querySelector('.gallery');\nconst loadMoreBtn = document.querySelector('.load-more');\nconst loader = document.querySelector('.loader');\n\nconst lightbox = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nexport function createGallery(images = []) {\n  if (!galleryContainer) return;\n  const markup = images\n    .map(\n      img => `\n<li class=\"gallery__item\">\n  <a class=\"gallery__link\" href=\"${img.largeImageURL}\">\n    <img class=\"gallery__image\" src=\"${img.webformatURL}\" alt=\"${img.tags}\" loading=\"lazy\" />\n  </a>\n</li>`\n    )\n    .join('');\n  galleryContainer.insertAdjacentHTML('beforeend', markup);\n  lightbox.refresh();\n}\n\nexport function clearGallery() {\n  if (!galleryContainer) return;\n  galleryContainer.innerHTML = '';\n  lightbox.refresh();\n}\n\nexport function showLoader() {\n  if (!loader) return;\n  loader.classList.add('is-visible');\n}\nexport function hideLoader() {\n  if (!loader) return;\n  loader.classList.remove('is-visible');\n}\n\nexport function showLoadMoreButton() {\n  if (!loadMoreBtn) return;\n  loadMoreBtn.classList.add('is-visible');\n}\nexport function hideLoadMoreButton() {\n  if (!loadMoreBtn) return;\n  loadMoreBtn.classList.remove('is-visible');\n}\n\nexport { galleryContainer as galleryEl, loadMoreBtn as loadMoreElement, loader as loaderElement };\n","import { getImagesByQuery } from './js/pixabay-api.js';\nimport {\n  createGallery,\n  clearGallery,\n  showLoader,\n  hideLoader,\n  showLoadMoreButton,\n  hideLoadMoreButton,\n  galleryEl,\n  loadMoreElement,\n} from './js/render-functions.js';\n\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nconst form = document.querySelector('form');\nconst input = document.querySelector('.search-input');\n\nlet currentQuery = '';\nlet page = 1;\nconst PER_PAGE = 15;\n\nform.addEventListener('submit', onSearch);\nif (loadMoreElement) {\n  loadMoreElement.addEventListener('click', onLoadMore);\n}\n\nasync function onSearch(evt) {\n  evt.preventDefault();\n  const query = input.value.trim();\n\n  if (!query) {\n    iziToast.warning({ title: 'Увага', message: 'Введіть пошуковий запит' });\n    return;\n  }\n\n  currentQuery = query;\n  page = 1;\n  clearGallery();\n  hideLoadMoreButton();\n\n  try {\n    showLoader();\n    const data = await getImagesByQuery(currentQuery, page);\n    const { hits = [], totalHits = 0 } = data;\n\n    if (!hits.length) {\n      iziToast.error({\n        title: 'Нічого не знайдено',\n        message: `За запитом \"${currentQuery}\" результатів немає`,\n      });\n      return;\n    }\n    createGallery(hits);\n    iziToast.success({\n      title: 'Знайдено',\n      message: `Знайдено ${totalHits} зображень`,\n    });\n\n    if (totalHits > page * PER_PAGE) {\n      showLoadMoreButton();\n    } else {\n      hideLoadMoreButton();\n      iziToast.info({\n        title: 'Кінець колекції',\n        message: \"We're sorry, but you've reached the end of search results.\",\n      });\n    }\n  } catch (err) {\n    console.error(err);\n    iziToast.error({\n      title: 'Помилка',\n      message: err.message || 'Щось пішло не так',\n    });\n  } finally {\n    hideLoader();\n  }\n}\n\nasync function onLoadMore() {\n  loadMoreElement.disabled = true;\n  page += 1;\n\n  try {\n    showLoader();\n    const data = await getImagesByQuery(currentQuery, page);\n    const { hits = [], totalHits = 0 } = data;\n\n    if (!hits.length) {\n      iziToast.info({\n        title: 'Кінець колекції',\n        message: \"We're sorry, but you've reached the end of search results.\",\n      });\n      hideLoadMoreButton();\n      return;\n    }\n\n    const prevLastCard = galleryEl.lastElementChild;\n    createGallery(hits);\n\n    if (prevLastCard) {\n      const { height: cardHeight } = prevLastCard.getBoundingClientRect();\n      window.scrollBy({ top: cardHeight * 2, behavior: 'smooth' });\n    }\n\n    if (totalHits > page * PER_PAGE) {\n      showLoadMoreButton();\n    } else {\n      hideLoadMoreButton();\n      iziToast.info({\n        title: 'Кінець колекції',\n        message: \"We're sorry, but you've reached the end of search results.\",\n      });\n    }\n\n  } catch (err) {\n    console.error(err);\n    iziToast.error({\n      title: 'Помилка',\n      message: err.message || 'Не вдалося завантажити дані',\n    });\n  } finally {\n    hideLoader();\n    loadMoreElement.disabled = false;\n  }\n}\n"],"names":["API_KEY","BASE_URL","PER_PAGE","getImagesByQuery","query","page","url","response","galleryContainer","loadMoreBtn","loader","lightbox","SimpleLightbox","createGallery","images","markup","img","clearGallery","showLoader","hideLoader","showLoadMoreButton","hideLoadMoreButton","form","input","currentQuery","onSearch","loadMoreElement","onLoadMore","evt","iziToast","data","hits","totalHits","err","prevLastCard","galleryEl","cardHeight"],"mappings":"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"}